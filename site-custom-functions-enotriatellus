<?php
/**
 * Plugin Name: Site Custom Functions
 * Description: Plugin che raccoglie le funzioni e personalizzazioni custom del sito.
 * Version: 1.0.0
 * Author: Marchetti Design
 */

if (!defined('ABSPATH')) exit; // Sicurezza: blocca accesso diretto

// Mostra un messaggio di test nella dashboard (area admin)
add_action('admin_notices', function () {
    echo '<div class="notice notice-success is-dismissible">
		<p><strong>Messaggio di test</strong> â€” il plugin Site Custom Functions Ã¨ attivo! ðŸš€</p>
    </div>';
});


// Aggiunge testo all'email di conferma ordine se Ã¨ presente un certo prodotto
add_action( 'woocommerce_email_before_order_table', 'am_add_text_for_specific_product', 10, 4 );

function am_add_text_for_specific_product( $order, $sent_to_admin, $plain_text, $email ) {

    // Mostra solo nell'email di conferma ordine (non nelle altre)
    if ( $email->id !== 'customer_completed_order' ) {
        return;
    }

    // ID del prodotto da controllare
    $target_product_id = 1234; // <-- cambia con lâ€™ID del tuo prodotto

    // Controlla se l'ordine contiene quel prodotto
    foreach ( $order->get_items() as $item ) {
        if ( $item->get_product_id() == $target_product_id ) {
            
            // Testo personalizzato
            echo '<p><strong>Grazie! ðŸŽ‰</strong> Con questo prodotto hai accesso a un bonus speciale...</p>';
            break;
        }
    }
}
